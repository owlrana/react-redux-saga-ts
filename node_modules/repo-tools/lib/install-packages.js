"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = exports.describe = exports.command = void 0;
var child_process_1 = require("child_process");
var chalk = require("chalk");
var helpers_1 = require("./helpers");
exports.command = 'install-packages';
exports.describe = 'Run `npm install` if package.json has changed';
var handler = function () {
    return helpers_1.run('git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD')
        .then(function (_a) {
        var _b;
        var stdout = _a.stdout;
        if (stdout.match('package.json')) {
            console.log(chalk.yellow('▼ package.json is modified. Running `npm install`...'));
            (_b = child_process_1.exec('npm install').stdout) === null || _b === void 0 ? void 0 : _b.pipe(process.stdout);
        }
        else {
            console.log(chalk.green('✔ Nothing to update'));
        }
    })
        .catch(function (err) {
        throw new Error(err);
    });
};
exports.handler = handler;
//# sourceMappingURL=install-packages.js.map